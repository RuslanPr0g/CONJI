<div class="app-wrapper">
  <div class="search-bar glass-card">
    <input
      #searchInput
      type="text"
      [formControl]="searchControl"
      placeholder="Caută cuvinte"
    />
  </div>

  <div class="grid-container">
    <ng-container *ngIf="filteredWords.length > 0; else noResults">
      <div
        class="word-block glass-card"
        *ngFor="let word of getDisplayedWords()"
        (click)="copyToClipboard(word.value)"
        tabindex="0"
        role="button"
      >
        <div class="word-value">{{ word.value }}</div>
        <div
          class="word-translations"
          *ngIf="
            !word.translations || word.translations.length > 0;
            else noTranslations
          "
        >
          <small>
            <span
              *ngFor="let translation of word.translations; let last = last"
            >
              {{ translation }}<span *ngIf="!last"> • </span>
            </span>
          </small>
        </div>
        <ng-template #noTranslations>
          <small><em>—</em></small>
        </ng-template>
        <div
          class="similar-words"
          *ngIf="word.similarWords && word.similarWords.length > 0"
        >
          <small>
            <span class="label">Exemple similare:</span>
            <span *ngFor="let similar of word.similarWords; let last = last">
              {{ similar }}<span *ngIf="!last"> • </span>
            </span>
          </small>
        </div>
      </div>
    </ng-container>

    <ng-template #noResults>
      <p class="no-results"><em>Niciun rezultat găsit</em></p>
    </ng-template>
  </div>

  <button
    *ngIf="filteredWords.length > loadedCount"
    class="load-more"
    (click)="loadMore()"
  >
    Încarcă mai multe
  </button>
</div>

<div
  *ngIf="isGamingMode"
  class="popup-overlay"
  (click)="closePopup()"
  (keydown.enter)="closePopup()"
  tabindex="0"
>
  <ng-container *ngTemplateOutlet="gamingScreen"></ng-container>
</div>

<ng-template #gamingScreen>
  <div
    class="popup-content glass-card"
    (click)="$event.stopPropagation()"
    (keydown.enter)="$event.stopPropagation()"
    tabindex="0"
  >
    <div class="popup-header">
      <h2>Joacă</h2>

      <div class="popup-translations">
        Încearcă să ghicești care este cuvântu
      </div>
      <ng-template #noPopupTranslations>
        <small><em>—</em></small>
      </ng-template>

      <button
        class="popup-close"
        (click)="closePopup()"
        (keydown.enter)="closePopup()"
        tabindex="0"
      >
        ×
      </button>
    </div>

    <div class="popup-body">
      <div class="glass-card">
        <app-guess-words [words]="filteredWords"> </app-guess-words>
      </div>
    </div>
  </div>
</ng-template>

<div *ngIf="copiedText" class="copy-toast">Copiat: „{{ copiedText }}”</div>

<ng-container *ngIf="filteredWords.length > 0">
  <div class="float-btn">
    <button
      class="float-btn-item"
      (click)="activateGamingMode()"
      (keydown.enter)="activateGamingMode()"
    >
      Joacă!
    </button>
  </div>
</ng-container>
